<!DOCTYPE html>
<body>
  sds
</body>
<script>
  var tasksNum = 1000;

  requestIdleCallback(unImportWork);

  function unImportWork(deadline) {
    console.log(deadline.timeRemaining());
    while (deadline.timeRemaining() && tasksNum > 0) {
      console.log(`执行了${1000 - tasksNum + 1}个任务`);
      tasksNum--;
    }

    if (tasksNum > 0) {
      // 在未来的帧中继续执行
      requestIdleCallback(unImportWork);
    }
  }
</script>
